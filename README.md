# AstrBot Live2D æ¡Œé¢åº”ç”¨

åŸºäº Electron + Vue3 + TypeScript çš„ Live2D æ¡Œé¢å±•ç¤ºåº”ç”¨ï¼Œå¯ä¸ AstrBot æœåŠ¡å™¨é€šè¿‡ WebSocket è¿æ¥è¿›è¡Œå®æ—¶è¡¨æ¼”äº¤äº’ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ­ **Live2D æ¸²æŸ“**ï¼šæ”¯æŒ Cubism 2/4 æ¨¡å‹ï¼Œæ”¯æŒåŠ¨ä½œã€è¡¨æƒ…ã€éŸ³é¢‘ã€è§†é¢‘ç­‰å¤šåª’ä½“è¡¨æ¼”
- ğŸ”Œ **å®æ—¶è¿æ¥**ï¼šé€šè¿‡ WebSocket ä¸ AstrBot æœåŠ¡å™¨è¿æ¥
- ğŸ“Š **æ•°æ®ç»Ÿè®¡**ï¼šæ¶ˆæ¯å†å²è®°å½•ã€æ•°æ®å¯è§†åŒ–åˆ†æ
- âš™ï¸ **çµæ´»é…ç½®**ï¼šçª—å£ç½®é¡¶ã€é¼ æ ‡ç©¿é€ã€è‡ªåŠ¨è¿æ¥ç­‰é«˜çº§é€‰é¡¹
- ğŸ¨ **ç•Œé¢ç¾è§‚**ï¼šåŸºäº Naive UI çš„ç°ä»£åŒ–ç•Œé¢è®¾è®¡

## æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**ï¼šVue 3 + TypeScript + Vite
- **æ¡Œé¢æ¡†æ¶**ï¼šElectron 28
- **UI ç»„ä»¶åº“**ï¼šNaive UI
- **çŠ¶æ€ç®¡ç†**ï¼šPinia
- **å›¾è¡¨å¯è§†åŒ–**ï¼šECharts
- **æ•°æ®åº“**ï¼šBetter-SQLite3
- **Live2D**ï¼špixi-live2d-display

## å¼€å‘ç¯å¢ƒ

### å‰ç½®è¦æ±‚

- Node.js >= 18
- npm / yarn / pnpm

### å®‰è£…ä¾èµ–

```bash
npm install
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run electron:dev
```

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
# æ„å»ºæ‰€æœ‰å¹³å°
npm run build

# ä»…æ„å»º Windows
npm run build:win

# æ„å»ºåˆ°ç›®å½•ï¼ˆä¸æ‰“åŒ…å®‰è£…ç¨‹åºï¼‰
npm run build:dir
```

## é¡¹ç›®ç»“æ„

```
desktop/
â”œâ”€â”€ electron/              # Electron ä¸»è¿›ç¨‹ä»£ç 
â”‚   â”œâ”€â”€ main.ts           # ä¸»è¿›ç¨‹å…¥å£
â”‚   â”œâ”€â”€ preload.ts        # é¢„åŠ è½½è„šæœ¬
â”‚   â”œâ”€â”€ windows/          # çª—å£ç®¡ç†
â”‚   â”œâ”€â”€ ipc/              # IPC é€šä¿¡å¤„ç†
â”‚   â”œâ”€â”€ bridge/           # WebSocket æ¡¥æ¥
â”‚   â””â”€â”€ database/         # SQLite æ•°æ®åº“
â”œâ”€â”€ src/                  # Vue æ¸²æŸ“è¿›ç¨‹ä»£ç 
â”‚   â”œâ”€â”€ windows/          # çª—å£ç»„ä»¶
â”‚   â”œâ”€â”€ components/       # å…¬å…±ç»„ä»¶
â”‚   â”œâ”€â”€ stores/           # Pinia çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ assets/           # é™æ€èµ„æº
â”œâ”€â”€ public/               # å…¬å…±èµ„æº
â”‚   â””â”€â”€ models/           # Live2D æ¨¡å‹å­˜æ”¾
â”œâ”€â”€ resources/            # æ‰“åŒ…èµ„æºï¼ˆå›¾æ ‡ç­‰ï¼‰
â””â”€â”€ package.json          # é¡¹ç›®é…ç½®
```

## ä½¿ç”¨è¯´æ˜

### 1. å¯¼å…¥ Live2D æ¨¡å‹

é¦–æ¬¡å¯åŠ¨æ—¶ï¼Œéœ€è¦å…ˆå¯¼å…¥ä¸€ä¸ª Live2D æ¨¡å‹ï¼š

1. ç‚¹å‡»ä¸»çª—å£çš„"å¯¼å…¥æ¨¡å‹"æŒ‰é’®
2. é€‰æ‹©æ¨¡å‹é…ç½®æ–‡ä»¶ï¼ˆ`.model.json` æˆ– `.model3.json`ï¼‰
3. ç­‰å¾…æ¨¡å‹åŠ è½½å®Œæˆ

### 2. è¿æ¥æœåŠ¡å™¨

åœ¨è®¾ç½®çª—å£ä¸­é…ç½® WebSocket è¿æ¥ï¼š

1. å¡«å†™æœåŠ¡å™¨åœ°å€ï¼ˆå¦‚ `ws://localhost:6185`ï¼‰
2. å¯é€‰å¡«å†™è®¤è¯ä»¤ç‰Œ
3. ç‚¹å‡»"è¿æ¥"æŒ‰é’®

### 3. æŸ¥çœ‹å†å²è®°å½•

åœ¨å†å²è®°å½•çª—å£ä¸­å¯ä»¥ï¼š

- æŸ¥çœ‹æ¶ˆæ¯å†å²
- æŸ¥çœ‹ç»Ÿè®¡å›¾è¡¨
- åˆ†æè¡¨æ¼”æ•°æ®

## é…ç½®é€‰é¡¹

### è¿æ¥é…ç½®

- æœåŠ¡å™¨åœ°å€
- è®¤è¯ä»¤ç‰Œ

### æ¨¡å‹ç®¡ç†

- å¯¼å…¥/åˆ é™¤æ¨¡å‹
- åˆ‡æ¢å½“å‰æ¨¡å‹
- æ¨¡å‹è‡ªåŠ¨åŠ è½½

### è¡¨æ¼”è®¾ç½®

- é»˜è®¤åŠ¨ä½œç»„
- æ–‡å­—æ˜¾ç¤ºæ—¶é•¿
- åŠ¨ä½œä¼˜å…ˆçº§
- è‡ªåŠ¨æ’­æ”¾åŠ¨ç”»

### é«˜çº§é€‰é¡¹

- çª—å£ç½®é¡¶
- é¼ æ ‡ç©¿é€
- å¯åŠ¨æ—¶è‡ªåŠ¨è¿æ¥
- å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½æ¨¡å‹

## æ•°æ®æŒä¹…åŒ–

åº”ç”¨ä½¿ç”¨ä»¥ä¸‹æ–¹å¼å­˜å‚¨æ•°æ®ï¼š

- **SQLite æ•°æ®åº“**ï¼šæ¶ˆæ¯å†å²ã€è¡¨æ¼”è®°å½•ã€ç»Ÿè®¡æ•°æ®
- **LocalStorage**ï¼šç”¨æˆ·è®¾ç½®ã€æ¨¡å‹è·¯å¾„ç­‰è½»é‡é…ç½®
- **æ–‡ä»¶ç³»ç»Ÿ**ï¼šå¯¼å…¥çš„ Live2D æ¨¡å‹æ–‡ä»¶

æ•°æ®å­˜å‚¨ä½ç½®ï¼š
- Windows: `%APPDATA%/astrbot-live2d-desktop/`
- macOS: `~/Library/Application Support/astrbot-live2d-desktop/`
- Linux: `~/.config/astrbot-live2d-desktop/`

## æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨å…±äº«çš„ PIXI Application é¿å… WebGL ä¸Šä¸‹æ–‡è€—å°½
- ECharts å›¾è¡¨è‡ªé€‚åº”çª—å£å¤§å°
- æŒ‰éœ€åŠ è½½å’Œä»£ç åˆ†å‰²ï¼ˆNaive UIã€EChartsã€Vendorï¼‰
- ç”Ÿäº§æ„å»ºå¯ç”¨å‹ç¼©å’Œæ··æ·†

## å·²çŸ¥é—®é¢˜

- **moc3 v6 æ”¯æŒ**ï¼šå½“å‰ä½¿ç”¨çš„ Cubism Core 5.1.0 ä»…æ”¯æŒ moc3 v5ï¼Œv6 æ¨¡å‹æš‚ä¸æ”¯æŒ
- **CSP unsafe-eval**ï¼šPIXI.js éœ€è¦ eval() ç¼–è¯‘ WebGL ç€è‰²å™¨ï¼Œå¼€å‘ç¯å¢ƒä¼šæœ‰è­¦å‘Š

## åè®®

L2D-Bridge Protocol v1.0

è¯¦è§ï¼š`AstrBot/data/plugins/astrbot-live2d-adapter/API.md`

## è®¸å¯è¯

MIT License

## ç›¸å…³é“¾æ¥

- [AstrBot](https://github.com/Soulter/AstrBot)
- [pixi-live2d-display](https://github.com/guansss/pixi-live2d-display)
- [Live2D Cubism SDK](https://www.live2d.com/download/cubism-sdk/)

